<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CultureVerse - Discover Your Next Favorite</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .heading-font {
            font-family: 'Playfair Display', serif;
        }
        .category-badge {
            transition: all 0.3s ease;
        }
        .category-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .article-card {
            transition: all 0.3s ease;
        }
        .article-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .spoiler-content {
            transition: max-height 0.5s ease, opacity 0.5s ease;
        }
        .pagination-btn {
            transition: all 0.2s ease;
        }
        .pagination-btn:hover {
            transform: scale(1.05);
        }
        .recommendation-card {
            transition: all 0.3s ease;
        }
        .recommendation-card:hover {
            transform: translateY(-3px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Фон -->
<div id="page-bg"
     class="fixed inset-0 -z-20 bg-no-repeat bg-cover bg-center">
</div>

<!-- затемнение -->
<div class="pointer-events-none fixed inset-0 -z-10 bg-gradient-to-b from-transparent via-transparent to-gray-50"></div>

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center">
                    <i data-feather="book-open" class="text-white"></i>
                </div>
                <h1 class="text-2xl font-bold heading-font text-gray-800 hovered-element">CultureVerse</h1>
            </a>
            
            <nav class="hidden md:flex space-x-8" id="category-nav">
    <button data-category="All" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">All</button>
    <button data-category="Books" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">Books</button>
    <button data-category="Movies" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">Movies</button>
    <button data-category="Series" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">Series</button>
    <button data-category="Anime" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">Anime</button>
    <button data-category="Games" class="category-btn text-gray-600 hover:text-indigo-600 font-medium">Games</button>
</nav>

            
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <input type="text" placeholder="Search articles..." class="pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    <i data-feather="search" class="absolute left-3 top-2.5 text-gray-400"></i>
                     <div class="suggestions absolute bg-white border border-gray-200 mt-1 w-full rounded-md shadow-lg z-50 hidden"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
   <!-- Hero Section -->
<section id="hero-section" class="py-12 relative text-white">
  <!-- Фон из Strapi -->
  <div id="hero-bg" class="absolute inset-0 -z-10"></div>

  <div class="container mx-auto px-4 text-center relative">
    <h1 class="text-4xl md:text-5xl font-bold heading-font mb-4" data-aos="fade-up">
      Discover Your Next Obsession
    </h1>
    <p class="text-xl max-w-2xl mx-auto mb-8" data-aos="fade-up" data-aos-delay="100">
      Explore reviews, recommendations, and deep dives into books, movies, series, anime, and games.
    </p>
    <div class="max-w-2xl mx-auto mb-8" data-aos="fade-up" data-aos-delay="150">
      <div class="relative">
        <input type="text" placeholder="Search articles..." 
               class="w-full pl-12 pr-4 py-3 rounded-full border-0 
                      focus:ring-2 focus:ring-white focus:ring-opacity-50 
                      bg-white bg-opacity-20 text-white 
                      placeholder-white placeholder-opacity-70">
        <i data-feather="search" class="absolute left-4 top-3.5 text-white text-opacity-70"></i>
        <div class="suggestions absolute bg-white text-black border border-gray-200 mt-1 w-full rounded-md shadow-lg z-50 hidden"></div>
      </div>
    </div>
  </div>
</section>


    <!-- Articles Grid -->
    <section class="py-12">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold heading-font text-gray-800 mb-8 text-center">Latest Articles</h2>
            
            <div id="articles" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>

            
            <!-- Pagination -->
            <div class="flex justify-center mt-12">
                <nav class="flex items-center space-x-4">
                    <button id="prevPage" class="pagination-btn w-12 h-12 flex items-center justify-center rounded-full bg-white border border-gray-200 text-gray-500 hover:bg-gray-50 transition-transform hover:scale-105">
                        <i data-feather="chevron-left" class="w-6 h-6"></i>
                    </button>
                    
                    <div class="flex items-center space-x-2">
                        <span id="currentPage" class="text-lg font-medium">1</span>
                        <span class="text-gray-500">of</span>
                        <span id="totalPages" class="text-lg font-medium">5</span>
                    </div>
                    
                    <button id="nextPage" class="pagination-btn w-12 h-12 flex items-center justify-center rounded-full bg-white border border-gray-200 text-gray-500 hover:bg-gray-50 transition-transform hover:scale-105">
                        <i data-feather="chevron-right" class="w-6 h-6"></i>
                    </button>
                </nav>
            </div>

            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    const articlesContainer = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3');
                    const articles = Array.from(articlesContainer.children);
                    const articlesPerPage = 12;
                    const totalPages = Math.ceil(articles.length / articlesPerPage);
                    let currentPage = 1;
                    
                    // Initialize total pages display
                    document.getElementById('totalPages').textContent = totalPages;
                    
                    // Function to show articles for current page
                    function showPage(page) {
                        const startIdx = (page - 1) * articlesPerPage;
                        const endIdx = startIdx + articlesPerPage;
                        
                        articles.forEach((article, index) => {
                            if (index >= startIdx && index < endIdx) {
                                article.style.display = 'block';
                                article.setAttribute('data-aos-delay', (index % articlesPerPage) * 50);
                            } else {
                                article.style.display = 'none';
                            }
                        });
                        
                        document.getElementById('currentPage').textContent = page;
                        currentPage = page;
                        
                        // Update button states
                        document.getElementById('prevPage').disabled = page === 1;
                        document.getElementById('nextPage').disabled = page === totalPages;
                    }
                    
                    // Initial page load
                    showPage(1);
                    
                    // Pagination button event listeners
                    document.getElementById('prevPage').addEventListener('click', () => {
                        if (currentPage > 1) {
                            showPage(currentPage - 1);
                            window.scrollTo({ top: articlesContainer.offsetTop - 100, behavior: 'smooth' });
                        }
                    });
                    
                    document.getElementById('nextPage').addEventListener('click', () => {
                        if (currentPage < totalPages) {
                            showPage(currentPage + 1);
                            window.scrollTo({ top: articlesContainer.offsetTop - 100, behavior: 'smooth' });
                        }
                    });
                    
                    // Keyboard navigation
                    document.addEventListener('keydown', (e) => {
                        if (e.key === 'ArrowLeft' && currentPage > 1) {
                            showPage(currentPage - 1);
                            window.scrollTo({ top: articlesContainer.offsetTop - 100, behavior: 'smooth' });
                        } else if (e.key === 'ArrowRight' && currentPage < totalPages) {
                            showPage(currentPage + 1);
                            window.scrollTo({ top: articlesContainer.offsetTop - 100, behavior: 'smooth' });
                        }
                    });
                });
            </script>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white pt-16 pb-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center">
                            <i data-feather="book-open" class="text-white w-4 h-4"></i>
                        </div>
                        <h3 class="text-xl font-bold heading-font">CultureVerse</h3>
                    </div>
                    <p class="text-gray-400 mb-4">Your ultimate destination for entertainment insights, reviews, and recommendations across books, movies, series, anime, and games.</p>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Categories</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Books</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Movies</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">TV Series</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Anime</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Games</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Company</h4>
                    <ul class="space-y-2">
                        <li><a href="about-us.html" class="text-gray-400 hover:text-white">About Us</a></li>
                        <li><a href="privacy-policy.html" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
                        <li><a href="terms-of-service.html" class="text-gray-400 hover:text-white">Terms of Service</a></li>
                    </ul>
                </div>
                
            </div>
            
            <div class="pt-8 border-t border-gray-700 text-center text-gray-400">
                <p class="text-center">&copy; 2025 CultureVerse. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>AOS.init();</script>
    <script>feather.replace();</script>
    <script>
  const API_URL = "https://strapi-production-cb57.up.railway.app";
</script>
<script>
let allArticles = []; // все статьи
let activeCategory = "All"; // текущая категория
let searchQuery = ""; // текущий текст поиска

async function loadArticles() {
  try {
   const response = await fetch(`${API_URL}/api/articles?populate=*`);
    const data = await response.json();
    allArticles = data.data; 
    applyFilters(); // применяем фильтры после загрузки
  } catch (error) {
    console.error("Ошибка загрузки статей:", error);
  }
}

function applyFilters() {
  let filtered = allArticles;

  // фильтр по категории
  if (activeCategory !== "All") {
    filtered = filtered.filter(a => a.article_category === activeCategory);
  }

  // фильтр по поиску (по началу слова)
  if (searchQuery) {
    filtered = filtered.filter(a => {
   const title = (a.Title || a.article_title || "").toLowerCase();
      return (
        title.startsWith(searchQuery) ||
        title.split(" ").some(word => word.startsWith(searchQuery))
      );
    });
  }

  renderArticles(filtered);
}

function renderArticles(articles) {
  const container = document.querySelector("#articles");
  container.innerHTML = "";

  if (!articles.length) {
    container.innerHTML = "<p class='text-gray-500 text-center'>Нет статей</p>";
    return;
  }

  articles.forEach(attrs => {
  const title = attrs.Title || attrs.article_title || "Без названия";
const preview = Array.isArray(attrs.article_preview)
  ? (attrs.article_preview[0]?.children?.[0]?.text || "")
  : "";
    const category = attrs.article_category || "General";

    let coverUrl = "https://via.placeholder.com/640x360";
   if (attrs.Cover) {
  if (attrs.Cover.formats?.medium) coverUrl = `${API_URL}${attrs.Cover.formats.medium.url}`;
  else if (attrs.Cover.formats?.small) coverUrl = `${API_URL}${attrs.Cover.formats.small.url}`;
  else if (attrs.Cover.formats?.thumbnail) coverUrl = `${API_URL}${attrs.Cover.formats.thumbnail.url}`;
  else if (attrs.Cover.url) coverUrl = `${API_URL}${attrs.Cover.url}`;
}


    const card = `
      <div class="article-card bg-white rounded-xl overflow-hidden shadow-md" data-aos="fade-up">
        <img src="${coverUrl}" alt="${title}" class="w-full h-48 object-cover">
        <div class="p-6">
          <div class="flex justify-between items-start mb-3">
            <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold px-2.5 py-0.5 rounded">${category}</span>
            <span class="text-gray-500 text-sm">${new Date(attrs.createdAt).toLocaleDateString()}</span>
          </div>
          <h3 class="text-xl font-bold heading-font text-gray-800 mb-2">${title}</h3>
          <p class="text-gray-600 mb-4">${preview}</p>
          <a href="article.html?id=${attrs.id}" class="text-indigo-600 font-medium hover:text-indigo-800 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" class="feather feather-play mr-2">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            Play
          </a>
        </div>
      </div>
    `;
    container.innerHTML += card;
  });
}

document.addEventListener("DOMContentLoaded", () => {
  // 1. читаем search из URL
  const params = new URLSearchParams(window.location.search);
  const initialSearch = (params.get("search") || "").trim();
  if (initialSearch) {
    searchQuery = initialSearch.toLowerCase();

    // Заполняем оба поля поиска этим текстом
    document.querySelectorAll("input[placeholder='Search articles...']").forEach(input => {
      input.value = initialSearch;
    });
  }

  // 2. загружаем статьи
  loadArticles();

  // 3. фильтрация по категориям
  document.querySelectorAll(".category-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      activeCategory = btn.getAttribute("data-category");
      applyFilters();
    });
  });

  // 4. поиск в обоих инпутах
  document.querySelectorAll("input[placeholder='Search articles...']").forEach(input => {
    input.addEventListener("input", e => {
      searchQuery = e.target.value.toLowerCase();
      applyFilters();
    });
  });
});

<script>
async function loadBackground() {
  const bgDiv = document.getElementById("page-bg");
  if (!bgDiv) return;

  try {
    // всегда берём defaultBackground из Theme
    const res = await fetch(`${API_URL}/api/theme?populate=defaultBackground`);
    const json = await res.json();

    // у Strapi v4 данные лежат в data.attributes
    const theme = json?.data?.attributes || json?.data || {};
    const bg = theme.defaultBackground;

    let bgUrl = null;

    if (bg) {
      // сначала смотрим форматы
      bgUrl =
        bg.formats?.large?.url ||
        bg.formats?.medium?.url ||
        bg.formats?.small?.url ||
        bg.url;
    }

    if (bgUrl) {
      if (!bgUrl.startsWith("http")) {
        bgUrl = `${API_URL}${bgUrl}`;
      }
      bgDiv.style.backgroundImage = `url('${bgUrl}')`;
      bgDiv.style.backgroundSize = "cover";
      bgDiv.style.backgroundPosition = "center";
    }
  } catch (err) {
    console.error("Ошибка загрузки defaultBackground:", err);
  }
}

document.addEventListener("DOMContentLoaded", loadBackground);
</script>

<script>
async function loadHeroBackground() {
  const heroDiv = document.getElementById("hero-bg");
  if (!heroDiv) return;

  try {
    const res = await fetch(`${API_URL}/api/theme?populate=heroBackground`);
    const json = await res.json();
    const theme = json?.data || {};
    const heroBg = theme.heroBackground;

    if (heroBg) {
      // Берём оптимальный размер
      let bgUrl = heroBg.formats?.large?.url || heroBg.formats?.medium?.url || heroBg.url;
      if (bgUrl) {
        if (!bgUrl.startsWith("http")) bgUrl = `${API_URL}${bgUrl}`;
        heroDiv.style.backgroundImage = `url('${bgUrl}')`;
        heroDiv.style.backgroundSize = "cover";
        heroDiv.style.backgroundPosition = "center";
      }
    } else {
      // fallback: если нет картинки
      heroDiv.style.background = "linear-gradient(to right, #6366f1, #9333ea)";
    }
  } catch (err) {
    console.error("Ошибка загрузки heroBackground:", err);
  }
}
document.addEventListener("DOMContentLoaded", loadHeroBackground);
</script>

<script>
async function loadHeroTextColors() {
  try {
    const res = await fetch(`${API_URL}/api/theme?populate=*`);
    const json = await res.json();
    const theme = json?.data?.attributes || json?.data || {};

    // Заголовок
    if (theme.heroTitleColor) {
      document.querySelector("#hero-section h1").style.color = theme.heroTitleColor;
    }

    // Подзаголовок
    if (theme.heroSubtitleColor) {
      document.querySelector("#hero-section p").style.color = theme.heroSubtitleColor;
    }
  } catch (err) {
    console.error("Ошибка загрузки цветов:", err);
  }
}
document.addEventListener("DOMContentLoaded", loadHeroTextColors);
</script>
<script>
async function loadHeroSearchColors() {
  try {
    const res = await fetch(`${API_URL}/api/theme?populate=*`);
    const json = await res.json();
    const theme = json?.data?.attributes || json?.data || {};

    const searchInput = document.querySelector("#hero-section input[placeholder='Search articles...']");
    if (searchInput) {
      // Фон
      if (theme.heroSearchBgColor) {
        searchInput.style.backgroundColor = theme.heroSearchBgColor;
      }

      // Текст
      if (theme.heroSearchTextColor) {
        searchInput.style.color = theme.heroSearchTextColor;
      }

      // Placeholder
      if (theme.heroSearchPlaceholderColor) {
        searchInput.style.setProperty("--placeholder-color", theme.heroSearchPlaceholderColor);

        // CSS-хак для кастомного placeholder
        const style = document.createElement("style");
        style.innerHTML = `
          #hero-section input::placeholder {
            color: var(--placeholder-color);
          }
        `;
        document.head.appendChild(style);
      }
    }
  } catch (err) {
    console.error("Ошибка загрузки цветов поиска:", err);
  }
}
document.addEventListener("DOMContentLoaded", loadHeroSearchColors);
</script>


</body>
</html>
